<html>
<header>
    <script src="js/brain.js"></script>
    <script src="js/data.js"></script>
</header>

<body>
    <div>
        <p id="input"></p>
        <p id="output"></p>
        <button title="test" onclick="test()">test</button>
    </div>
    <script>
        let rnntimestep_obj = {
            "type": "LSTMTimeStep",
            "options": {
                "inputSize": 7,
                "hiddenLayers": [10],
                "outputSize": 7,
                "decayRate": 0.999,
                "smoothEps": 1e-8,
                "regc": 0.000001,
                "clipval": 5
            },
            "hiddenLayers": [{
                "inputMatrix": {
                    "rows": 10,
                    "columns": 7,
                    "weights": {
                        "0": 0.26258987188339233,
                        "1": 1.176139235496521,
                        "2": 0.2906266450881958,
                        "3": 1.0479326248168945,
                        "4": 0.14316092431545258,
                        "5": 0.22124400734901428,
                        "6": 0.16458819806575775,
                        "7": 0.2191658914089203,
                        "8": -0.04167165607213974,
                        "9": 0.23828090727329254,
                        "10": 0.27705609798431396,
                        "11": 0.14397861063480377,
                        "12": 0.10487709194421768,
                        "13": 0.007107493933290243,
                        "14": 0.23356269299983978,
                        "15": 0.962173581123352,
                        "16": 0.36082935333251953,
                        "17": 0.9111067652702332,
                        "18": 0.0511343739926815,
                        "19": 0.18361108005046844,
                        "20": 0.17245036363601685,
                        "21": 2.90106201171875,
                        "22": 2.338754177093506,
                        "23": 2.671766519546509,
                        "24": 4.846709251403809,
                        "25": 0.6145979762077332,
                        "26": 2.018583297729492,
                        "27": -0.013896189630031586,
                        "28": 1.097312569618225,
                        "29": 3.1437830924987793,
                        "30": 1.3500179052352905,
                        "31": 0.3163866400718689,
                        "32": 1.0017114877700806,
                        "33": 1.3360779285430908,
                        "34": -0.009328886866569519,
                        "35": 0.157541885972023,
                        "36": 1.113179087638855,
                        "37": 0.3066975176334381,
                        "38": 0.9470593929290771,
                        "39": 0.04978621006011963,
                        "40": 0.25044557452201843,
                        "41": 0.11692939698696136,
                        "42": 0.38333845138549805,
                        "43": 5.229403972625732,
                        "44": 2.5346202850341797,
                        "45": 5.310173988342285,
                        "46": 1.1927719116210938,
                        "47": 0.43974199891090393,
                        "48": -0.015908583998680115,
                        "49": 0.21754568815231323,
                        "50": 1.1612067222595215,
                        "51": 0.34334996342658997,
                        "52": 0.8891369104385376,
                        "53": 0.09895791858434677,
                        "54": 0.29161253571510315,
                        "55": 0.15154877305030823,
                        "56": 0.6147662401199341,
                        "57": 4.588916778564453,
                        "58": 3.154326915740967,
                        "59": 4.820863246917725,
                        "60": -0.6629803776741028,
                        "61": 0.7130914330482483,
                        "62": -0.02031444013118744,
                        "63": 0.1561700850725174,
                        "64": 3.5887558460235596,
                        "65": 1.6251707077026367,
                        "66": 3.5527946949005127,
                        "67": 0.6497219800949097,
                        "68": 0.18691600859165192,
                        "69": -0.011624651961028576
                    }
                },
                "inputHidden": {
                    "rows": 10,
                    "columns": 10,
                    "weights": {
                        "0": -1.0621581077575684,
                        "1": -0.5129465460777283,
                        "2": -1.0810682773590088,
                        "3": 0.9286623597145081,
                        "4": 0.08888446539640427,
                        "5": 0.37972599267959595,
                        "6": 1.6692558526992798,
                        "7": -0.9969194531440735,
                        "8": -1.8447264432907104,
                        "9": -1.1953308582305908,
                        "10": -0.06247621029615402,
                        "11": -0.2120283544063568,
                        "12": 0.003525676904246211,
                        "13": 1.3939194679260254,
                        "14": -0.8726677894592285,
                        "15": 0.31706610321998596,
                        "16": 1.5324236154556274,
                        "17": -1.3819406032562256,
                        "18": -2.2988944053649902,
                        "19": -0.1306227296590805,
                        "20": -0.8353023529052734,
                        "21": -0.3195396065711975,
                        "22": -0.5547075271606445,
                        "23": 0.94339919090271,
                        "24": -0.695533037185669,
                        "25": 0.2282731980085373,
                        "26": 1.3650093078613281,
                        "27": -1.1060494184494019,
                        "28": -1.7459125518798828,
                        "29": -1.110801339149475,
                        "30": 1.410376787185669,
                        "31": -1.1747033596038818,
                        "32": 1.185002088546753,
                        "33": -1.3790521621704102,
                        "34": 0.9628555774688721,
                        "35": -1.115707278251648,
                        "36": -1.1694177389144897,
                        "37": 1.585410475730896,
                        "38": 1.3923462629318237,
                        "39": 1.4823265075683594,
                        "40": -3.369154691696167,
                        "41": 1.098491907119751,
                        "42": 0.4283231794834137,
                        "43": 3.7236015796661377,
                        "44": -0.04870409891009331,
                        "45": 2.004650592803955,
                        "46": 2.053842306137085,
                        "47": -2.8487184047698975,
                        "48": -2.1378824710845947,
                        "49": -4.252834320068359,
                        "50": -0.9314404726028442,
                        "51": -0.43072614073753357,
                        "52": -0.9436145424842834,
                        "53": 0.8061039447784424,
                        "54": -0.6675280332565308,
                        "55": 0.2169300764799118,
                        "56": 1.4894042015075684,
                        "57": -0.7070586681365967,
                        "58": -1.4703898429870605,
                        "59": -0.9927400946617126,
                        "60": -6.7573089599609375,
                        "61": 1.92917001247406,
                        "62": -1.841288447380066,
                        "63": 2.0955183506011963,
                        "64": -8.009652137756348,
                        "65": 1.460174322128296,
                        "66": 5.053226470947266,
                        "67": -4.516474723815918,
                        "68": -2.6836774349212646,
                        "69": -4.030333995819092,
                        "70": -0.42577075958251953,
                        "71": -0.33206433057785034,
                        "72": -0.7028284072875977,
                        "73": 1.2271099090576172,
                        "74": -0.518839955329895,
                        "75": 0.4404439330101013,
                        "76": 1.9325788021087646,
                        "77": -2.089496374130249,
                        "78": -1.7583001852035522,
                        "79": -0.4839804172515869,
                        "80": -5.466119289398193,
                        "81": 3.093515396118164,
                        "82": -2.8601551055908203,
                        "83": 3.6120247840881348,
                        "84": -7.699016094207764,
                        "85": 1.9704034328460693,
                        "86": 6.2954864501953125,
                        "87": -5.184835910797119,
                        "88": -3.595108985900879,
                        "89": -5.183839321136475,
                        "90": -5.148205757141113,
                        "91": -0.16658563911914825,
                        "92": -1.2210087776184082,
                        "93": 1.2183037996292114,
                        "94": -10.366442680358887,
                        "95": 0.7812145352363586,
                        "96": 3.1802639961242676,
                        "97": -2.700873613357544,
                        "98": -1.0940015316009521,
                        "99": -2.8779542446136475
                    }
                },
                "inputBias": {
                    "rows": 10,
                    "columns": 1,
                    "weights": {
                        "0": 7.054851531982422,
                        "1": 9.102482795715332,
                        "2": 6.781172275543213,
                        "3": 5.308242321014404,
                        "4": 4.644993305206299,
                        "5": 7.734316349029541,
                        "6": 4.224917411804199,
                        "7": 6.993330001831055,
                        "8": 2.60764741897583,
                        "9": 6.727797985076904
                    }
                },
                "forgetMatrix": {
                    "rows": 10,
                    "columns": 7,
                    "weights": {
                        "0": 0.18305045366287231,
                        "1": 0.6883193254470825,
                        "2": 0.6545577645301819,
                        "3": 0.7864165902137756,
                        "4": 0.2414262592792511,
                        "5": 0.21543513238430023,
                        "6": 0.7060340046882629,
                        "7": 0.8767257332801819,
                        "8": -12.614205360412598,
                        "9": -3.625596284866333,
                        "10": 1.7343989610671997,
                        "11": 1.9061174392700195,
                        "12": -1.0674824714660645,
                        "13": -0.013123408891260624,
                        "14": 0.16963186860084534,
                        "15": 1.5511821508407593,
                        "16": 0.6699169278144836,
                        "17": 1.0634284019470215,
                        "18": 0.32129812240600586,
                        "19": 0.23486492037773132,
                        "20": 0.007172107696533203,
                        "21": 0.1495465636253357,
                        "22": 1.2973082065582275,
                        "23": 0.5487049221992493,
                        "24": 1.132818579673767,
                        "25": 0.2721208333969116,
                        "26": 0.16104084253311157,
                        "27": 0.07922884076833725,
                        "28": 1.2073695659637451,
                        "29": 14.121102333068848,
                        "30": 9.662035942077637,
                        "31": 15.451112747192383,
                        "32": 2.8987183570861816,
                        "33": 1.0692261457443237,
                        "34": -0.023788830265402794,
                        "35": 0.1589476764202118,
                        "36": 3.1655750274658203,
                        "37": 1.0098700523376465,
                        "38": 2.492373466491699,
                        "39": 0.25116613507270813,
                        "40": 0.16530998051166534,
                        "41": -0.002222270704805851,
                        "42": 0.5301242470741272,
                        "43": 10.622958183288574,
                        "44": 5.373303413391113,
                        "45": 6.762620449066162,
                        "46": 1.123656153678894,
                        "47": 0.5783491730690002,
                        "48": -0.010201535187661648,
                        "49": 0.389936625957489,
                        "50": 1.4192626476287842,
                        "51": 0.28989967703819275,
                        "52": 0.9055042862892151,
                        "53": 0.2868993878364563,
                        "54": 0.31666702032089233,
                        "55": 0.09946870058774948,
                        "56": 0.19391654431819916,
                        "57": 1.1349552869796753,
                        "58": 0.663809061050415,
                        "59": 1.1992377042770386,
                        "60": 0.24577385187149048,
                        "61": 0.173485666513443,
                        "62": 0.024505358189344406,
                        "63": 0.22224311530590057,
                        "64": 0.8127985000610352,
                        "65": 0.8376721143722534,
                        "66": 1.0520280599594116,
                        "67": 0.2849518954753876,
                        "68": 0.10438753664493561,
                        "69": 0.15437600016593933
                    }
                },
                "forgetHidden": {
                    "rows": 10,
                    "columns": 10,
                    "weights": {
                        "0": -1.1882790327072144,
                        "1": 2.023988723754883,
                        "2": -1.1532808542251587,
                        "3": 1.5881750583648682,
                        "4": -1.0478166341781616,
                        "5": 0.8963874578475952,
                        "6": 2.6019296646118164,
                        "7": -1.8355392217636108,
                        "8": -2.1326870918273926,
                        "9": -1.2842981815338135,
                        "10": -10.681614875793457,
                        "11": 4.70639705657959,
                        "12": -3.795149326324463,
                        "13": 6.212428092956543,
                        "14": -9.853926658630371,
                        "15": -1.3192161321640015,
                        "16": 7.771974086761475,
                        "17": -8.803130149841309,
                        "18": -5.579866886138916,
                        "19": -7.747622489929199,
                        "20": -1.4296940565109253,
                        "21": -0.27479180693626404,
                        "22": -0.536984920501709,
                        "23": 1.4603067636489868,
                        "24": 0.20054887235164642,
                        "25": 0.584267258644104,
                        "26": 2.5128684043884277,
                        "27": -2.6466240882873535,
                        "28": -2.5821731090545654,
                        "29": -1.242520809173584,
                        "30": -0.9539692997932434,
                        "31": -0.6448752880096436,
                        "32": -0.6659419536590576,
                        "33": 1.1141999959945679,
                        "34": -1.4743529558181763,
                        "35": 0.46938616037368774,
                        "36": 2.4936180114746094,
                        "37": -2.9383902549743652,
                        "38": -1.6074174642562866,
                        "39": -0.7336189150810242,
                        "40": -5.712879657745361,
                        "41": 4.645664691925049,
                        "42": -3.9865095615386963,
                        "43": 5.990225315093994,
                        "44": -5.2319841384887695,
                        "45": 3.447617292404175,
                        "46": 4.947792053222656,
                        "47": -4.016823768615723,
                        "48": -6.012044429779053,
                        "49": -4.825652122497559,
                        "50": -2.5588741302490234,
                        "51": -0.5282709002494812,
                        "52": -1.2696173191070557,
                        "53": 1.4121960401535034,
                        "54": -6.456264972686768,
                        "55": 0.7909438014030457,
                        "56": 2.6948657035827637,
                        "57": -2.552722930908203,
                        "58": -1.3415862321853638,
                        "59": -2.2574009895324707,
                        "60": -3.576549768447876,
                        "61": 2.86657452583313,
                        "62": -2.207894802093506,
                        "63": 3.5190134048461914,
                        "64": -4.236985206604004,
                        "65": 2.0751447677612305,
                        "66": 3.0403947830200195,
                        "67": -3.5183353424072266,
                        "68": -2.9700772762298584,
                        "69": -2.467107057571411,
                        "70": -0.8826788067817688,
                        "71": 0.26970410346984863,
                        "72": -1.1542668342590332,
                        "73": 1.7312796115875244,
                        "74": -0.5186070799827576,
                        "75": 0.5250648856163025,
                        "76": 2.672950029373169,
                        "77": -2.293774127960205,
                        "78": -2.6156134605407715,
                        "79": -1.1042839288711548,
                        "80": -1.3920880556106567,
                        "81": -0.2884969413280487,
                        "82": -1.1189367771148682,
                        "83": 1.7624813318252563,
                        "84": -0.6836500763893127,
                        "85": 0.5531377792358398,
                        "86": 2.0110666751861572,
                        "87": -2.59728741645813,
                        "88": -2.2146801948547363,
                        "89": -1.4062892198562622,
                        "90": -1.2311540842056274,
                        "91": 0.5284470319747925,
                        "92": -1.1266812086105347,
                        "93": 1.6731823682785034,
                        "94": -1.0411866903305054,
                        "95": 0.89224773645401,
                        "96": 2.426762342453003,
                        "97": -2.5479581356048584,
                        "98": -2.576141595840454,
                        "99": -1.241154432296753
                    }
                },
                "forgetBias": {
                    "rows": 10,
                    "columns": 1,
                    "weights": {
                        "0": 0,
                        "1": 0,
                        "2": 0,
                        "3": 0,
                        "4": 0,
                        "5": 0,
                        "6": 0,
                        "7": 0,
                        "8": 0,
                        "9": 0
                    }
                },
                "outputMatrix": {
                    "rows": 10,
                    "columns": 7,
                    "weights": {
                        "0": 0.8127424716949463,
                        "1": 16.85646629333496,
                        "2": 8.201417922973633,
                        "3": 16.845552444458008,
                        "4": 2.693359613418579,
                        "5": 0.8219393491744995,
                        "6": -0.02183651179075241,
                        "7": 0.11186060309410095,
                        "8": 0.590630829334259,
                        "9": 0.09722180664539337,
                        "10": 0.9738287329673767,
                        "11": 0.09683965146541595,
                        "12": 0.1328202784061432,
                        "13": 0.06626303493976593,
                        "14": 0.24448944628238678,
                        "15": 1.0305907726287842,
                        "16": 0.3144274950027466,
                        "17": 1.0437850952148438,
                        "18": 0.13700217008590698,
                        "19": 0.1417110115289688,
                        "20": 0.05049188435077667,
                        "21": 0.19084389507770538,
                        "22": 0.6662614941596985,
                        "23": 0.25693652033805847,
                        "24": 0.5282146334648132,
                        "25": 0.13232557475566864,
                        "26": 0.2116692066192627,
                        "27": 0.1690395176410675,
                        "28": 0.10242360085248947,
                        "29": 1.4562445878982544,
                        "30": -3.2627439498901367,
                        "31": 3.383269786834717,
                        "32": 0.5551301836967468,
                        "33": 0.3302822709083557,
                        "34": -0.0013241850538179278,
                        "35": 0.18822386860847473,
                        "36": 1.2871525287628174,
                        "37": 0.20330797135829926,
                        "38": 0.8020458817481995,
                        "39": 0.044216714799404144,
                        "40": 0.1735273003578186,
                        "41": 0.13545215129852295,
                        "42": 0.24762333929538727,
                        "43": 1.017419695854187,
                        "44": 0.49406954646110535,
                        "45": 1.4321396350860596,
                        "46": 0.19514861702919006,
                        "47": 0.20124611258506775,
                        "48": 0.17680418491363525,
                        "49": 0.15916374325752258,
                        "50": 3.2684051990509033,
                        "51": 1.665083885192871,
                        "52": 3.700472831726074,
                        "53": 0.551638662815094,
                        "54": 0.13268296420574188,
                        "55": -0.004700466524809599,
                        "56": 0.04467419534921646,
                        "57": 1.1855231523513794,
                        "58": 0.3924991190433502,
                        "59": 1.0600802898406982,
                        "60": 0.059694867581129074,
                        "61": 0.04516306519508362,
                        "62": 0.09692666679620743,
                        "63": 0.4591650366783142,
                        "64": 7.536492347717285,
                        "65": 4.0932488441467285,
                        "66": 5.891540050506592,
                        "67": 1.213748812675476,
                        "68": 0.4247187674045563,
                        "69": -0.012754370458424091
                    }
                },
                "outputHidden": {
                    "rows": 10,
                    "columns": 10,
                    "weights": {
                        "0": -5.368508338928223,
                        "1": 4.67529821395874,
                        "2": -3.944868326187134,
                        "3": 4.212445259094238,
                        "4": -5.950689315795898,
                        "5": 3.7041585445404053,
                        "6": 4.847790241241455,
                        "7": -4.775092601776123,
                        "8": -4.043448448181152,
                        "9": -4.586734294891357,
                        "10": -0.922612190246582,
                        "11": -0.6010208129882812,
                        "12": -0.774297297000885,
                        "13": 1.636309266090393,
                        "14": -0.6302323341369629,
                        "15": 0.26171305775642395,
                        "16": 1.644542932510376,
                        "17": -2.6764044761657715,
                        "18": -2.3637630939483643,
                        "19": -0.8088046312332153,
                        "20": -0.7320101261138916,
                        "21": -0.4908435344696045,
                        "22": -0.5144553780555725,
                        "23": 0.8843797445297241,
                        "24": -0.5520045757293701,
                        "25": 0.2950517237186432,
                        "26": 1.9655828475952148,
                        "27": -2.2912704944610596,
                        "28": -1.3756685256958008,
                        "29": -0.8055859208106995,
                        "30": -0.27926620841026306,
                        "31": -0.6730303764343262,
                        "32": -0.04911269620060921,
                        "33": 0.9563968777656555,
                        "34": -0.7742891907691956,
                        "35": 0.2572503685951233,
                        "36": 2.1407899856567383,
                        "37": -2.200035810470581,
                        "38": -1.6377793550491333,
                        "39": -0.3874230980873108,
                        "40": -1.0027210712432861,
                        "41": 0.8583343029022217,
                        "42": -1.5557867288589478,
                        "43": 1.3822669982910156,
                        "44": -1.9291956424713135,
                        "45": -0.2338569164276123,
                        "46": 0.6115351915359497,
                        "47": -1.1741695404052734,
                        "48": -2.161996603012085,
                        "49": -1.0427544116973877,
                        "50": -0.7720804214477539,
                        "51": -0.4882951080799103,
                        "52": -0.6517688632011414,
                        "53": 0.8234786987304688,
                        "54": -0.7318354249000549,
                        "55": 0.32297012209892273,
                        "56": 1.9031463861465454,
                        "57": -1.7081197500228882,
                        "58": -1.3177896738052368,
                        "59": -0.8218410015106201,
                        "60": -0.6822599172592163,
                        "61": -0.763556957244873,
                        "62": -0.5698879361152649,
                        "63": 0.38560304045677185,
                        "64": -0.5592631101608276,
                        "65": 0.4871295988559723,
                        "66": 1.7303540706634521,
                        "67": -2.361410140991211,
                        "68": -1.8191312551498413,
                        "69": -0.651103138923645,
                        "70": -2.9387238025665283,
                        "71": 3.6933178901672363,
                        "72": -1.154428243637085,
                        "73": 1.7189173698425293,
                        "74": -3.4655444622039795,
                        "75": 1.069381594657898,
                        "76": 2.4969637393951416,
                        "77": -2.1309609413146973,
                        "78": -1.4338656663894653,
                        "79": -1.6641017198562622,
                        "80": -0.4721134901046753,
                        "81": -0.30473792552948,
                        "82": -0.5996752977371216,
                        "83": 0.7776989340782166,
                        "84": -1.0461597442626953,
                        "85": 0.35530683398246765,
                        "86": 1.6198593378067017,
                        "87": -1.5541504621505737,
                        "88": -0.8749094009399414,
                        "89": -0.5341306924819946,
                        "90": -3.9082789421081543,
                        "91": 2.6006083488464355,
                        "92": -2.1244118213653564,
                        "93": 2.217258930206299,
                        "94": -3.9432168006896973,
                        "95": 1.7307192087173462,
                        "96": 2.7208425998687744,
                        "97": -2.565535306930542,
                        "98": -1.9444830417633057,
                        "99": -2.5476198196411133
                    }
                },
                "outputBias": {
                    "rows": 10,
                    "columns": 1,
                    "weights": {
                        "0": 5.178225040435791,
                        "1": 9.440730094909668,
                        "2": 7.2718939781188965,
                        "3": 8.350699424743652,
                        "4": 8.377950668334961,
                        "5": 8.970205307006836,
                        "6": 7.199466705322266,
                        "7": 8.245512962341309,
                        "8": 9.570232391357422,
                        "9": 4.793816566467285
                    }
                },
                "cellActivationMatrix": {
                    "rows": 10,
                    "columns": 7,
                    "weights": {
                        "0": -0.12250738590955734,
                        "1": -0.46392443776130676,
                        "2": -0.0679783746600151,
                        "3": -0.38912999629974365,
                        "4": -0.085693359375,
                        "5": -0.1333957314491272,
                        "6": -0.14420048892498016,
                        "7": -0.10533493757247925,
                        "8": 6.157130241394043,
                        "9": 2.574512004852295,
                        "10": 5.7366485595703125,
                        "11": 0.8857885599136353,
                        "12": 0.18011195957660675,
                        "13": -0.015614806674420834,
                        "14": -0.10983294248580933,
                        "15": -1.1429415941238403,
                        "16": -0.6723228096961975,
                        "17": -0.8795585632324219,
                        "18": -0.36149999499320984,
                        "19": -0.17558398842811584,
                        "20": 0.005858730990439653,
                        "21": 0.22694046795368195,
                        "22": 4.449402332305908,
                        "23": 1.8613994121551514,
                        "24": 4.189866065979004,
                        "25": 0.7211170196533203,
                        "26": 0.21545684337615967,
                        "27": -0.014683707617223263,
                        "28": -0.1771925538778305,
                        "29": -4.930713653564453,
                        "30": -2.3689370155334473,
                        "31": -4.729937553405762,
                        "32": -0.6423635482788086,
                        "33": -0.28466862440109253,
                        "34": 0.008324794471263885,
                        "35": 0.1276252120733261,
                        "36": 0.37127989530563354,
                        "37": 0.06186634302139282,
                        "38": 0.395901083946228,
                        "39": 0.044354937970638275,
                        "40": 0.146528422832489,
                        "41": 0.2757026255130768,
                        "42": 0.055438511073589325,
                        "43": 0.539454996585846,
                        "44": 0.21939100325107574,
                        "45": 0.4838315546512604,
                        "46": 0.09459495544433594,
                        "47": 0.10386230051517487,
                        "48": 0.2800687253475189,
                        "49": -0.14015884697437286,
                        "50": -0.5238416790962219,
                        "51": -0.2829735577106476,
                        "52": -0.6382693648338318,
                        "53": -0.03473185747861862,
                        "54": -0.03199012205004692,
                        "55": -0.03958619758486748,
                        "56": 0.18182314932346344,
                        "57": -1.2371774911880493,
                        "58": -0.6105696558952332,
                        "59": -1.0319936275482178,
                        "60": -3.4835288524627686,
                        "61": -0.6788105368614197,
                        "62": 0.0045623513869941235,
                        "63": -0.15078364312648773,
                        "64": -0.44808903336524963,
                        "65": -0.11673683673143387,
                        "66": -0.2872057855129242,
                        "67": 0.015908395871520042,
                        "68": -0.05874979868531227,
                        "69": -0.3659207224845886
                    }
                },
                "cellActivationHidden": {
                    "rows": 10,
                    "columns": 10,
                    "weights": {
                        "0": 0.43333563208580017,
                        "1": 0.13146287202835083,
                        "2": 0.7313732504844666,
                        "3": -0.5205134153366089,
                        "4": -0.16740836203098297,
                        "5": -0.09975934028625488,
                        "6": -0.617857038974762,
                        "7": 0.25856876373291016,
                        "8": 0.9671534895896912,
                        "9": 0.749010443687439,
                        "10": -5.090881824493408,
                        "11": 3.333552837371826,
                        "12": -1.9599478244781494,
                        "13": 2.326833963394165,
                        "14": -5.5698323249816895,
                        "15": 1.5515087842941284,
                        "16": 2.9029059410095215,
                        "17": -2.6228532791137695,
                        "18": -1.7401609420776367,
                        "19": -2.92167329788208,
                        "20": 1.5854476690292358,
                        "21": -0.37119585275650024,
                        "22": 0.6028847098350525,
                        "23": -0.6550626158714294,
                        "24": 3.3289623260498047,
                        "25": -0.234994038939476,
                        "26": -0.9300801753997803,
                        "27": 1.0365225076675415,
                        "28": 0.30083686113357544,
                        "29": 1.1672276258468628,
                        "30": -3.739062786102295,
                        "31": 2.5170347690582275,
                        "32": -1.4215692281723022,
                        "33": 1.9766703844070435,
                        "34": -4.66722297668457,
                        "35": 1.05563485622406,
                        "36": 2.3894882202148438,
                        "37": -2.2677865028381348,
                        "38": -1.4750137329101562,
                        "39": -2.245628833770752,
                        "40": 2.8013193607330322,
                        "41": -2.0237555503845215,
                        "42": 1.2324258089065552,
                        "43": -1.4095590114593506,
                        "44": 3.4315340518951416,
                        "45": -0.9778990149497986,
                        "46": -1.7890870571136475,
                        "47": 1.84269380569458,
                        "48": 1.1772464513778687,
                        "49": 1.7722976207733154,
                        "50": -0.4372762143611908,
                        "51": -0.24053192138671875,
                        "52": -0.6060300469398499,
                        "53": 0.41815054416656494,
                        "54": -0.5465128421783447,
                        "55": 0.2326330542564392,
                        "56": 0.4548393487930298,
                        "57": -0.17854388058185577,
                        "58": -0.549872875213623,
                        "59": -0.6698324680328369,
                        "60": -0.34309759736061096,
                        "61": -0.34392568469047546,
                        "62": -0.3548033535480499,
                        "63": 0.2568542957305908,
                        "64": -0.34760722517967224,
                        "65": 0.24631527066230774,
                        "66": 0.5626010894775391,
                        "67": -0.9587436318397522,
                        "68": -0.5243969559669495,
                        "69": -0.3966098725795746,
                        "70": 0.661624014377594,
                        "71": 0.29704833030700684,
                        "72": 0.5086284875869751,
                        "73": -0.501473605632782,
                        "74": 0.48335278034210205,
                        "75": -0.208683043718338,
                        "76": -1.0763643980026245,
                        "77": 1.088331699371338,
                        "78": 0.6904024481773376,
                        "79": 0.5958237051963806,
                        "80": -0.8515005707740784,
                        "81": 1.549490213394165,
                        "82": -0.3882404863834381,
                        "83": 0.6312354803085327,
                        "84": -0.3962841033935547,
                        "85": 0.38886886835098267,
                        "86": 0.3672967255115509,
                        "87": -0.23462988436222076,
                        "88": -0.4540574550628662,
                        "89": -0.2857830226421356,
                        "90": 0.41296008229255676,
                        "91": 0.1448780596256256,
                        "92": 0.5053068995475769,
                        "93": -0.489616334438324,
                        "94": -0.08875387161970139,
                        "95": -0.047911401838064194,
                        "96": -0.7583588361740112,
                        "97": 0.8235026597976685,
                        "98": 1.098454475402832,
                        "99": 0.39938053488731384
                    }
                },
                "cellActivationBias": {
                    "rows": 10,
                    "columns": 1,
                    "weights": {
                        "0": -4.432340145111084,
                        "1": 4.909297943115234,
                        "2": -3.9329655170440674,
                        "3": 2.817521572113037,
                        "4": -2.449023485183716,
                        "5": 4.239596366882324,
                        "6": 4.197849750518799,
                        "7": -4.864314079284668,
                        "8": -8.477753639221191,
                        "9": -4.381778717041016
                    }
                }
            }],
            "outputConnector": {
                "rows": 7,
                "columns": 10,
                "weights": {
                    "0": -0.39908567070961,
                    "1": 3.054020404815674,
                    "2": 1.3769285678863525,
                    "3": 1.3558236360549927,
                    "4": 0.513924777507782,
                    "5": -0.029761087149381638,
                    "6": 0.2204025834798813,
                    "7": -0.5000665187835693,
                    "8": 2.553244113922119,
                    "9": 1.0023882389068604,
                    "10": 0.07741978019475937,
                    "11": -0.12011474370956421,
                    "12": -0.22265681624412537,
                    "13": -0.19687074422836304,
                    "14": -0.3492247760295868,
                    "15": 0.2661106288433075,
                    "16": 0.2557480037212372,
                    "17": 0.46066445112228394,
                    "18": -0.021572845056653023,
                    "19": -0.04826178401708603,
                    "20": -0.11246384680271149,
                    "21": 0.214817076921463,
                    "22": 0.012058069929480553,
                    "23": -0.45034635066986084,
                    "24": 0.028238456696271896,
                    "25": -0.4998873174190521,
                    "26": -0.5319330096244812,
                    "27": 0.08799757063388824,
                    "28": 0.3785715699195862,
                    "29": -0.12960490584373474,
                    "30": -0.05120350047945976,
                    "31": -0.12274479866027832,
                    "32": -0.01102208811789751,
                    "33": -0.03323908522725105,
                    "34": 0.03533678874373436,
                    "35": 0.012747665867209435,
                    "36": -0.1621319055557251,
                    "37": -0.061587415635585785,
                    "38": -0.08943197876214981,
                    "39": -0.27370667457580566,
                    "40": 0.10405910760164261,
                    "41": 0.13911795616149902,
                    "42": 2.156780481338501,
                    "43": 0.5751230716705322,
                    "44": 0.44720375537872314,
                    "45": 0.976142406463623,
                    "46": -0.24331504106521606,
                    "47": -1.5467742681503296,
                    "48": -2.5562033653259277,
                    "49": 0.5785114765167236,
                    "50": 0.458707720041275,
                    "51": 0.4885075092315674,
                    "52": -0.009572003036737442,
                    "53": 3.2428815364837646,
                    "54": 0.37020206451416016,
                    "55": 1.3948190212249756,
                    "56": 1.7138646841049194,
                    "57": -1.7230037450790405,
                    "58": 0.5082902908325195,
                    "59": -0.23306232690811157,
                    "60": -0.07095743715763092,
                    "61": 0.046126656234264374,
                    "62": -0.04766952246427536,
                    "63": 0.06205989420413971,
                    "64": -0.082022525370121,
                    "65": 0.07376957684755325,
                    "66": 0.06042441725730896,
                    "67": -0.09210740774869919,
                    "68": -0.05055369436740875,
                    "69": -0.07390464842319489
                }
            },
            "output": {
                "rows": 7,
                "columns": 1,
                "weights": {
                    "0": 7.83082389831543,
                    "1": -0.2648954689502716,
                    "2": 1.6715950965881348,
                    "3": -0.0030023108702152967,
                    "4": 0.3052048683166504,
                    "5": 1.1418108940124512,
                    "6": -0.5073652863502502
                }
            }
        }
    </script>
    <script>
        const net = new brain.recurrent.LSTMTimeStep();

        var sample_data = []
        var test_data = []
        var training_data = []

        function getIndex(key, value) {
            let index = map_normalization[key].indexOf(value)
            if (index !== -1) {
                return index
            } else {
                map_normalization[key].push(value)
                return map_normalization[key].length - 1
            }
        }

        function train() {
            processSampleData()

            console.log("training data %o", training_data)

            net.train([training_data], {
                // Defaults values --> expected validation
                iterations: 10000, // the maximum times to iterate the training data --> number greater than 0
                errorThresh: 0.005, // the acceptable error percentage from training data --> number between 0 and 1
                momentum: 0.05,
                log: false, // true to use console.log, when a function is supplied it is used --> Either true or a function
                logPeriod: 10, // iterations between logging out --> number greater than 0
                learningRate: 0.01, // scales with delta to effect training rate --> number between 0 and 1
            });

            let test_value = training_data.pop()

            console.log(test_value)
            console.log(JSON.stringify(net))


            const output = net.run([test_value]);

            document.getElementById('input').innerHTML = JSON.stringify(test_value)
            document.getElementById('output').innerHTML = JSON.stringify(output)

            console.log(output)
            console.log(JSON.stringify(net))
        }

        function test() {

            /* var test_data = []
            for (var i = 0; i < 5; i++) {
                let randIndex = Math.floor(Math.random() * training_data.length);
                let sampleTest = training_data[randIndex]
                test_data.push(sampleTest)
            } */

            let randIndex = Math.floor(Math.random() * training_data.length);
            let sampleTest = training_data[randIndex]

            /* console.log(sampleTest) */
            /* let output = net.run(sampleTest) */

            let output = net.forecast([sampleTest], 1)

            let forcast_reports = output.map((forecast) => {
                return {
                    "PH": forecast['0'],
                    "AMMONIA_TOTAL_MGL_N": forecast['1'],
                    "NITRATE_TOTAL_MGLASN": forecast['2'],
                    "INORGANIC_PHOSPHATE": forecast['3'],
                    "BOD": forecast['4'],
                    "DISSOLVED_OXYGEN_MGL": forecast['5'],
                    "FECAL_COLIFORMS": forecast['6'],
                }
            })

            let output_grade = forcast_reports.map((report) => {
                return {
                    report,
                    grade: getGrade(report)
                }
            })

            /* console.log(output_grade) */
            document.getElementById('input').innerHTML = JSON.stringify(sampleTest)
            document.getElementById('output').innerHTML = JSON.stringify(output_grade)
        }


        function loadANN() {
            processSampleData()
            net.fromJSON(rnntimestep_obj)
        }

        function shuffle(array) {
            var currentIndex = array.length,
                temporaryValue, randomIndex;

            // While there remain elements to shuffle...
            while (0 !== currentIndex) {

                // Pick a remaining element...
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;

                // And swap it with the current element.
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }

            return array;
        }

        function processSampleData() {
            sample_data = sample.map((item) => {
                let raw_item = {
                    "PH": Number(item.PH),
                    "AMMONIA_TOTAL_MGL_N": Number(item.AMMONIA_TOTAL_MGL_N),
                    "NITRATE_TOTAL_MGLASN": Number(item.NITRATE_TOTAL_MGLASN),
                    "INORGANIC_PHOSPHATE": Number(item.INORGANIC_PHOSPHATE),
                    "BOD": Number(item.BOD),
                    "DISSOLVED_OXYGEN_MGL": Number(item.DISSOLVED_OXYGEN_MGL),
                    "FECAL_COLIFORMS": Number(item.FECAL_COLIFORMS),
                }
                let input = Object.keys(raw_item).map((key) => {
                    return raw_item[key]
                })
                return input
            })


            /* console.log("map normalize %o", map_normalization)
            console.log("training data %o", sample_data) */
            sample_data = shuffle(sample_data)
            console.log("training data %o", sample_data)

            let train_set = Math.floor(sample_data.length / 1.5)
            training_data = sample_data.splice(0, train_set)
            test_data = sample_data
        }

        function getGrade(report) {
            let wqi = computeWQI(report)
            var eq = ""

            if (wqi > 95) {
                eq = "excellent"
            } else if (wqi > 80) {
                eq = "good"
            } else if (wqi > 65) {
                eq = "fair"
            } else if (wqi > 45) {
                eq = "marginal"
            } else {
                eq = "poor"
            }
            return {
                wqi,
                eq
            }
        }

        function computeWQI(report) {
            let f1 = computeFunction1(report)
            let f2 = computeFunction2([report])
            let f3 = computeFunction3(report)

            let f1pow = Math.pow(f1, 2)
            let f2pow = Math.pow(f2, 2)
            let f3pow = Math.pow(f3, 2)

            return 100 - (Math.sqrt(f1pow + f2pow + f3pow) / 1.732)
        }


        function computeFunction1(report) {
            let n = Object.keys(report).length

            let failed = Object.keys(report).map(key => {
                let value = report[key]
                return getBestWorst(key, value)
            }).filter((item) => {
                return !item.passed
            })
            console.log(failed)

            return (failed.length / n) * 100
        }

        function computeFunction2(reports) {
            let n = reports.length

            let failed_reports = reports.map((report) => {
                return Object.keys(report).map(key => {
                    let value = report[key]
                    return getBestWorst(key, value)
                }).filter((item) => {
                    return !item.passed
                }).length
            })

            var sum_failed = 0
            failed_reports.map((count) => {
                sum_failed += count
            })

            let total_test_n = Object.keys(reports[0]).length * n

            return (sum_failed / total_test_n) * 100
        }

        function computeFunction3(report) {
            let n = Object.keys(report).length
            let failed_test = Object.keys(report).map(key => {
                let value = report[key]
                return getBestWorst(key, value)
            }).filter((item) => {
                return !item.passed
            })

            let excursions = failed_test.map((test) => {
                return computeExcursion(test)
            })

            var sum_excursions = 0
            excursions.map((excursion) => {
                sum_excursions += excursion
            })
            let normalized = sum_excursions / n
            return (normalized / ((0.01 * normalized) + 0.01))
        }

        function computeExcursion(test) {
            if (test.best < test.value) {
                return (test.value / test.best) - 1
            } else {
                return (test.best / test.value) - 1
            }
        }



        function computeParam(type, value) {
            let param_value = getBestWorst(type)
            let computed_value = 100 * ((value - param_value.best) / (param_value.worst - param_value.best))
            return computed_value
        }

        function getBestWorst(type, value) {
            switch (type) {
                case 'PH':
                    return {
                        worst: 8,
                            best: 7,
                            passed: value < 8 && value >= 7,
                            value,
                            type
                    }
                    case 'AMMONIA_TOTAL_MGL_N':
                        return {
                            worst: 0.27,
                                best: 0.05,
                                passed: value < 0.21 && value >= 0.05,
                                value,
                                type
                        }
                        case 'NITRATE_TOTAL_MGLASN':
                            return {
                                worst: 10,
                                    best: 0,
                                    passed: value < 8 && value >= 0,
                                    value,
                                    type
                            }
                            case 'INORGANIC_PHOSPHATE':
                                return {
                                    worst: 0.75,
                                        best: 0.06,
                                        passed: value < 0.4 && value >= 0.06,
                                        value,
                                        type
                                }
                                case 'BOD':
                                    return {
                                        worst: 100,
                                            best: 2,
                                            passed: value < 6 && value >= 1,
                                            value,
                                            type
                                    }
                                    case 'DISSOLVED_OXYGEN_MGL':
                                        return {
                                            worst: 0,
                                                best: 10,
                                                passed: value > 4,
                                                value,
                                                type
                                        }
                                        case 'FECAL_COLIFORMS':
                                            return {
                                                worst: 200,
                                                    best: 50,
                                                    passed: value <= 100,
                                                    value,
                                                    type
                                            }
            }
        }

        train()
        /* processSampleData()
        loadANN() */
    </script>
</body>

</html>